(this.webpackJsonp=this.webpackJsonp||[]).push([[32],{5775:function(e,a,t){"use strict";t.r(a);var r=t(1),s=t.n(r),n=t(1029),o=t.n(n),d=t(306),i=t(32),l=t(14),c=t.n(l),p=t(1542),m=t.n(p),w=t(1511),g=t(5725),u=t(1819),h=t(1812),f=t(1777),P=t(1770),E=t(1783),y=t(66),C=t.n(y);const b=Object(h.a)(e=>({createTitle:{color:e.palette.getContrastText(e.palette.background.default)},formContent:{"& span, & div, & p, & input":{color:e.palette.getContrastText(e.palette.background.paper)}}}));function v(e){const{title:a,children:t}=e,r=b();return s.a.createElement(w.a,{width:1,mt:5},s.a.createElement(g.a,{justify:"center",container:!0,spacing:3},s.a.createElement(g.a,{item:!0,sm:6,md:4},s.a.createElement(g.a,{container:!0,spacing:4},s.a.createElement(g.a,{item:!0,md:12,className:r.createTitle},a),s.a.createElement(g.a,{item:!0,md:12,className:r.formContent},s.a.createElement(E.a,{elevation:0},t))))))}v.propTypes={title:C.a.element.isRequired,children:C.a.element.isRequired};var x=v,M=t(1531),O=t(308),j=t(1027),S=t(166),T=t(167);function k(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function F(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?k(Object(t),!0).forEach((function(a){N(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function N(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}const q=Object(h.a)(e=>({mandatoryStarText:{"& label>span:nth-child(1)":{color:"red"}},passwordChangeForm:{"& > span, & div, & p, & input":{color:e.palette.getContrastText(e.palette.primary.main)}}}));function R(e,a){let{field:t,value:r}=a;return F(F({},e),{},{[t]:r})}a.default=()=>{const{settings:{IsPasswordChangeEnabled:e,userStorePasswordPattern:a,passwordPolicyPattern:t,passwordPolicyMinLength:n,passwordPolicyMaxLength:l}}=Object(T.d)(),p=q(),h=i.a.getUser().name,E={currentPassword:void 0,newPassword:void 0,repeatedNewPassword:void 0},[y,C]=Object(r.useReducer)(R,E),{currentPassword:b,newPassword:v,repeatedNewPassword:k}=y,F=c.a.passwordChange.guidelinesEnabled;let N=[];F&&(N=c.a.passwordChange.policyList);const D=()=>{let e=m.a.string().empty();n&&-1!==n&&(e=e.min(n)),l&&-1!==l&&(e=e.max(l));const r=e.validate(v).error;if(r){const e=r.details[0].type;if("string.empty"===e)return s.a.createElement(d.a,{id:"Change.Password.password.empty",defaultMessage:"Password is empty"});if("string.min"===e)return s.a.createElement(d.a,{id:"Change.Password.password.length.short",defaultMessage:"Password is too short!"});if("string.max"===e)return s.a.createElement(d.a,{id:"Change.Password.password.length.long",defaultMessage:"Password is too long!"})}if(a){const e=m.a.string().pattern(new RegExp(a)).validate(v).error;if(e){if("string.pattern.base"===e.details[0].type)return s.a.createElement(d.a,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"})}}if(t){const e=m.a.string().pattern(new RegExp(t)).validate(v).error;if(e){if("string.pattern.base"===e.details[0].type)return s.a.createElement(d.a,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"})}}return!1},I=()=>{if(k&&v!==k)return s.a.createElement(d.a,{id:"Change.Password.password.mismatch",defaultMessage:"Password doesn't match"})},B=e=>{let{target:{name:a,value:t}}=e;C({field:a,value:t})},L=()=>{if(!k||v===k){return(new O.a).changePassword(b,v).then(e=>{j.a.success(s.a.createElement(d.a,{id:"Change.Password.password.changed.success",defaultMessage:"User password changed successfully. Please use the new password on next sign in"})),window.history.back()}).catch(e=>{switch(e.response.body.code){case 901450:j.a.error(s.a.createElement(d.a,{id:"Change.Password.password.change.disabled",defaultMessage:"Password change disabled"}));break;case 901451:j.a.error(s.a.createElement(d.a,{id:"Change.Password.current.password.incorrect",defaultMessage:"Current password is incorrect"}));break;case 901452:j.a.error(s.a.createElement(d.a,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"}))}})}j.a.error(s.a.createElement(d.a,{id:"Change.Password.password.mismatch",defaultMessage:"Password doesn't match"}))},W=s.a.createElement(s.a.Fragment,null,s.a.createElement(P.a,{variant:"h5",component:"h1"},s.a.createElement(d.a,{id:"Change.Password.title",defaultMessage:"Change Password"}),": "+h),s.a.createElement(P.a,{variant:"caption"},s.a.createElement(d.a,{id:"Change.Password.description",defaultMessage:"Change your own password. Required fields are marked with an asterisk ( * )"})),F&&N.length>0?s.a.createElement(P.a,{variant:"body2"},s.a.createElement(d.a,{id:"Change.Password.password.policy",defaultMessage:"Password policy:"}),s.a.createElement("ul",{style:{marginTop:"-4px",marginBottom:"-8px"}},N.map(e=>s.a.createElement("li",null,e)))):null);return void 0===e?s.a.createElement(S.a,null):e?s.a.createElement(x,{title:W,className:"change-password-form-wrapper"},s.a.createElement(w.a,{py:2,display:"flex",justifyContent:"center"},s.a.createElement(g.a,{item:!0,xs:10,md:9},s.a.createElement(w.a,{component:"div",m:2,className:"change-password-form"},s.a.createElement(g.a,{container:!0,mt:2,spacing:2,direction:"column",justify:"center",alignItems:"flex-start"},s.a.createElement(f.a,{classes:{root:o()(p.mandatoryStarText,"change-password-current")},required:!0,id:"current-password",autoFocus:!0,margin:"dense",name:"currentPassword",value:b,onChange:B,label:s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.current.password",defaultMessage:"Current Password"}),fullWidth:!0,error:""===b,helperText:s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.enter.current.password",defaultMessage:"Enter Current Password"}),variant:"outlined",type:"password"}),s.a.createElement(f.a,{classes:{root:o()(p.mandatoryStarText,"change-password-new")},margin:"dense",id:"new-password",name:"newPassword",value:v,onChange:B,label:s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.new.password",defaultMessage:"New Password"}),required:!0,fullWidth:!0,error:D(),helperText:D()||s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.enter.new.password",defaultMessage:"Enter a New Password"}),variant:"outlined",type:"password"}),s.a.createElement(f.a,{classes:{root:o()(p.mandatoryStarText,"change-password-new-repeat")},margin:"dense",id:"repeated-new-password",name:"repeatedNewPassword",value:k,onChange:B,label:s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.confirm.new.password",defaultMessage:"Confirm new Password"}),required:!0,fullWidth:!0,error:I(),helperText:I()||s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.confirmationOf.new.password",defaultMessage:"Confirmation of new Password"}),variant:"outlined",type:"password"}),s.a.createElement(w.a,{my:2,display:"flex",flexDirection:"row"},s.a.createElement(w.a,{mr:1},s.a.createElement(u.a,{color:"primary",variant:"contained",onClick:L,className:o()(p.passwordChangeForm,"change-password-save")},s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.Save.Button.text",defaultMessage:"Save"}))),s.a.createElement(w.a,{mx:1},s.a.createElement(u.a,{onClick:()=>window.history.back(),className:"change-password-cancel"},s.a.createElement(d.a,{id:"Settings.ChangePasswordForm.Cancel.Button.text",defaultMessage:"Cancel"}))))))))):s.a.createElement(M.a,null)}}}]);
//# sourceMappingURL=32.55788a8ee3e5d3a10af0.bundle.js.map